<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta name="author" content="Daning Huang" />
  <meta name="dcterms.date" content="2023-07-16" />
  <title>First-Order Partial Differential Equations</title>
  <style>
    html {
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      overflow-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 12px;
      }
      h1 {
        font-size: 1.8em;
      }
    }
    @media print {
      html {
        background-color: white;
      }
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, Consolas, 'Lucida Console', monospace;
      font-size: 85%;
      margin: 0;
      hyphens: manual;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
      overflow-wrap: normal;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC ul {
      padding-left: 1.3em;
    }
    #TOC > ul {
      padding-left: 0;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    /* The extra [class] is a hack that increases specificity enough to
       override a similar rule in reveal.js */
    ul.task-list[class]{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      font-size: inherit;
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
  </style>
  
  <script defer=""
  src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <link rel="stylesheet"
  href="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css" />
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
  
  
<header id="title-block-header">
<h1 class="title">First-Order Partial Differential Equations</h1>
<p class="author">Daning Huang</p>
<p class="date">07/16/2023</p>
</header>
<p><mark><em>Note: This chapter is expected to be after two chapters on
second-order PDEs. So the students are expected to know some basics
about PDEs, including a linear version of method of
characteristics.</em></mark></p>
<p><mark>Heroku in the text refers to examples on my website
https://aersp313.herokuapp.com/, as we have not converged on how to
integrate the interactions.</mark></p>
<h1 data-number="1" id="introduction"><span
class="header-section-number">1</span> Introduction</h1>
<p>In this chapter we consider a special type of Partial Differential
Equations (PDEs) that have only first-order partial derivatives, i.e.,
first-order PDEs. Just like the second-order PDEs that we have seen,
first-order PDEs play a fundamental role in many engineering
applications.</p>
<p>One important example is the Euler equation for compressible inviscid
flow; aerodynamic solvers based on Euler equations have been widely used
as cost-effective tools for the preliminary design of subsonic,
transonic and supersonic aircraft. The simplified one-dimensional Euler
equation reads <span class="math display">
\begin{aligned}
\rho_t + u\rho_x &amp;= 0 \\
u_t + \frac{1}{\rho}p_x &amp;= 0 \\
e_t + ue_t &amp;= 0
\end{aligned}
</span> where <span class="math inline">\rho</span> is the gas density,
<span class="math inline">u</span> the velocity, and <span
class="math inline">e</span> the energy; <span
class="math inline">p</span> is pressure as a function of <span
class="math inline">\rho</span> and <span class="math inline">u</span>.
As usual, the subscripts denote partial derivatives, e.g., <span
class="math inline">u_t = \frac{\partial u}{\partial t}</span>. Clearly,
the Euler equations are PDEs that only involve first-order
derivatives.</p>
<p>Another example is the traffic flow equation, <span
class="math display">
u_t+uu_x=0,\quad u(x,0)=\phi(x)
</span> where <span class="math inline">u</span> is the “density” of
vehicles, <span class="math inline">\phi</span> gives the initial
distribution of vehicles, and the PDE predicts how the vehicles would be
distributed over time. Unlike the previous example, the traffic flow
equation is a scalar one, i.e., there is only one unknown variable. Yet,
this surprisingly simple equation can explain the so-called phantom
traffic jams, where dense traffic comes to a halt and restarts for no
apparent reason.</p>
<h1 data-number="2" id="model-problem"><span
class="header-section-number">2</span> Model Problem</h1>
<p>This chapter will focus on the scalar first-order PDEs, and solve a
model problem in the following form: <span id="eq:model"><span
class="math display">
\begin{aligned}
\text{PDE:} &amp;\quad u_t+V(u,x,t)u_x = S(u,x,t) \\
\text{Initial condition:} &amp;\quad u(x,0) = \phi(x)
\end{aligned}
\qquad{(1)}</span></span> where <span class="math inline">u(x,t)</span>
is defined for <span class="math inline">x\in(-\infty,\infty)</span> and
<span class="math inline">t\in[0,\infty)</span>, i.e., the entire upper
part of <span class="math inline">x-t</span> plane. Due to the presence
of the initial condition, that are defined on the entire <span
class="math inline">x</span>-axis, Eq. 1 is an <strong>initial value
problem</strong> (IVP).</p>
<h2 data-number="2.1" id="sec:mean"><span
class="header-section-number">2.1</span> What does the PDE really
mean?</h2>
<p>We got three terms in the equation and let’s look at them one by one.
To facilitate a qualitative and tangible understanding, we can think
<span class="math inline">u</span> as the density distribution of some
gas that varies over space <span class="math inline">x</span> and time
<span class="math inline">t</span>; in this setup, the initial density
distribution is given by <span class="math inline">\phi(x)</span>. Also,
for simplicity, assume <span class="math inline">V</span> and <span
class="math inline">S</span> are constant.</p>
<p>First, the <span class="math inline">u_t</span> term is perhaps the
most straightforward one to understand - it means the rate of change in
the unknown variable, e.g., how the density vary over time. Next,
ignoring <span class="math inline">V u_x</span>, let’s look at the
combined effect of <span class="math inline">u_t</span> and <span
class="math inline">S</span>, i.e., <span
class="math inline">u_t=S</span>; this equation simply defines the rate
of change in <span class="math inline">u</span>. In our example, <span
class="math inline">S</span> functions as a source (sink) that adds
(removes) gas from the density distribution. Hence, we usually call
<span class="math inline">s</span> the <strong>source</strong> term,
with the understanding that a sink is as if a “negative source”.</p>
<p>Subsequently, let’s look at the combined effect of <span
class="math inline">u_t</span> and <span class="math inline">V
u_x</span>, ignoring the effect of the source term <span
class="math inline">S</span>. This gives us an equation <span
id="eq:meaning"><span class="math display">
u_t + V u_x = 0,\quad u(x,0) = \phi(x)
\qquad{(2)}</span></span> When <span class="math inline">V</span> is
constant, we can verify that the solution to Eq. 2 is <span
id="eq:msol"><span class="math display">
u(x,t) = \phi(x-Vt)
\qquad{(3)}</span></span></p>
<blockquote>
<p>Exercise: Verify the solution as an exercise. This can be done by
checking if Eq. 3 satisfies <em>both</em> the PDE and initial condition
in Eq. 2.</p>
<p>We will show how to find this solution very soon.</p>
</blockquote>
<p>What does Eq. 3 mean? If we substitute in some numbers: At <span
class="math inline">t=1</span>, <span class="math inline">u(x,t) =
\phi(x-V)</span>, and <span class="math inline">\phi(x-V)</span> is
simply the initial condition <span class="math inline">\phi(x)</span>
shifted to the right by <span class="math inline">V</span>; then at
<span class="math inline">t=2</span>, <span class="math inline">u(x,t) =
\phi(x-2V)</span> is <span class="math inline">\phi(x)</span> shifted to
the right by <span class="math inline">2V</span>, and so on. To
summarize, Eq. 3 is just representing that the initial condition <span
class="math inline">\phi(x)</span> is constantly shifted to the right at
a rate of <span class="math inline">V</span>, see
<strong>Visualization</strong>. In our example, this can mean that there
is constantly a wind blowing from left to right at the velocity <span
class="math inline">V</span>, that moves the initial gas distribution to
the right at the same rate; this phenomenon is
<strong>advection</strong>.</p>
<p>At this point, we can conclude that, qualitatively, the first-order
PDE describes the time variation of some quantity due to the combined
effects of <em>source</em> and <em>advection</em>.</p>
<p><mark>Heroku First-order PDE (3D) Case 1</mark></p>
<h2 data-number="2.2" id="plan-of-attack"><span
class="header-section-number">2.2</span> Plan of attack</h2>
<p>Now return to the more general model problem Eq. 1. You might have
noticed two key differences from the second-order PDEs we have solved so
far:</p>
<ol type="1">
<li>Eq. 1 does not have boundary conditions. There are fewer conditions
to satisfy and our life is thus <em>easier</em>.</li>
<li>Eq. 1 can be nonlinear, i.e., we might have terms involving products
of unknown functions and their derivatives. For example, if <span
class="math inline">V(u,x,t)=u^2</span>, we would get a nonlinear
convection term <span class="math inline">u^2 u_x</span> in the PDE. The
nonlinearity would make our life <em>harder</em>.</li>
</ol>
<p>Yet, luckily, Eq. 1 can be viewed as <em>quasi-linear</em>, in the
sense that the <span class="math inline">u_t</span> and <span
class="math inline">u_x</span> terms are always first-order regardless
of the nonlinearity in <span class="math inline">V</span> and <span
class="math inline">S</span>. Here “first-order” means that we do not
have “strange” terms such as <span class="math inline">u_t^2</span>,
<span class="math inline">\sqrt{u_x}</span>, <span
class="math inline">\sin(u_t)</span>, etc. We will leverage this
quasi-linearity and use a modified version of the <strong>method of
characteristics</strong> to solve the IVP of first-order PDEs.</p>
<h1 data-number="3"
id="method-of-characteristics-nonlinear-version"><span
class="header-section-number">3</span> Method of Characteristics:
Nonlinear Version</h1>
<h2 data-number="3.1" id="what-are-characteristics"><span
class="header-section-number">3.1</span> What are characteristics</h2>
<h3 data-number="3.1.1" id="definition"><span
class="header-section-number">3.1.1</span> Definition</h3>
<p>Let’s look at again the simple problem of advection with constant
velocity in Sec. 2.1: <span class="math display">u_t+Vu_x=0,\quad
u(x,0)=\phi(x)</span> the solution is Eq. 3, <span
class="math inline">u(x,t)=\phi(x-Vt)</span>. If we define a new
variable <span class="math inline">\eta(x,t)=x-Vt</span>, then <span
class="math inline">u</span> can be written as a <em>uni-variate</em>
function <span class="math inline">u(\eta)</span>. This fact actually
has a non-trivial implication for constant advection: For whatever
combination of <span class="math inline">(x,t)</span>, as long as <span
class="math inline">\eta</span> is the same, <span
class="math inline">u</span> remains the same.</p>
<p><mark>Heroku First-order PDE (2D) Case 1 Plot 3</mark></p>

<iframe src="myplot_small.html" width="600" height="520" scrolling="no" frameBorder="0" >
</iframe>

<p>Let’s use the <strong>Visualization</strong> to get a geometrical
intuition of what the implication means. In the numerical example, we
simply set <span class="math inline">V=1</span>, and <span
class="math inline">\eta=x-Vt=x-t</span> represents a straight line with
a slope <span class="math inline">1/V=1</span> that intersect <span
class="math inline">x</span>-axis at <span
class="math inline">x=\eta</span>. Also, we pick an initial condition
for the IVP <span class="math display">
\phi(x)=\exp(-(x-2)^2/2)
</span> This function is like a single wave: It has a peak of 1 at <span
class="math inline">x=2</span> and is almost zero when <span
class="math inline">x&lt;1</span> or <span
class="math inline">x&gt;3</span>.</p>
<p>Now we start from an arbitrary point on the <span
class="math inline">x</span>-axis, say <span
class="math inline">x=\eta=2</span>; at this point <span
class="math inline">\phi(2)=1</span> and <span
class="math inline">t=0</span>. Associated with the point <span
class="math inline">(x,t)=(2,0)</span>, we have a curve <span
class="math inline">2=x-t</span>. We can verify that the values of <span
class="math inline">u</span> at all the points on this curve, e.g.,
<span class="math inline">(3,1)</span>, <span
class="math inline">(4,2)</span>, <span
class="math inline">(5,3)</span>, etc., are the same as the value at the
point on the <span class="math inline">x</span>-axis <span
class="math inline">(x,t)=(2,0)</span>, i.e., <span
class="math display">
u(3,1)=u(4,2)=u(5,3)=\cdots=u(2,0)=\phi(2)=1
</span> Furthermore, note that the choice of point on the <span
class="math inline">x</span>-axis is arbitrary. This means we can just
pick any <span class="math inline">x=\eta</span> on the <span
class="math inline">x</span>-axis, and find a curve <span
class="math inline">\eta=x-Vt</span>; on this curve <span
class="math inline">u</span> is constantly <span
class="math inline">\phi(\eta)</span>.</p>
<blockquote>
<p>Exercise: Consider <span class="math inline">\phi(1.5)\approx
0.5</span>, and identify the combinations <span
class="math inline">(x,t)</span> for which <span
class="math inline">u=\phi(1.5)</span>.</p>
</blockquote>
<p>To sum up at this point, in the constant advection problem, the
equation <span class="math inline">\eta=x-Vt</span> represents a family
of special curve with a parameter <span class="math inline">\eta</span>;
every point on the <span class="math inline">x</span>-axis emanates one
curve and it runs forward in time. On each curve the variation of <span
class="math inline">u</span> is <em>greatly simplified</em>, in the
current case of which <span class="math inline">u</span> becomes
constant. This type of special curve is called the characteristic lines,
or <strong>characteristics</strong> for short.</p>
<h3 data-number="3.1.2" id="fixed-and-moving-frames"><span
class="header-section-number">3.1.2</span> Fixed and moving frames</h3>
<p>So far we have been looking at one characteristics at a time; this is
as if we slice the solution <span class="math inline">u</span> and the
<span class="math inline">(x,t)</span> plane along the characteristics,
so that we only look at this slice.</p>
<p>There are certainly other ways to slice the solution <span
class="math inline">u</span>, one of which is to slice at a time <span
class="math inline">t</span>. In this case, we can think the
characteristics as <em>rails</em>. Along the rails, a slice of solution
at <span class="math inline">t=0</span>, <span
class="math inline">u(x,0)</span>, moves forward by time <span
class="math inline">t</span>, and arrive at another slice of solution
<span class="math inline">u(x,t)</span>. Depending on the shape of
rails, the slice can shift to right or left, dilute or shrink, and so
on. In the constant advection problem, the characteristics run straight
to the right, hence the slice of solution simply shift to the right at
constant rate. We call this perspective of “characteristics as rails” as
<strong>fixed frame</strong>, since we are as if sitting on the <span
class="math inline">x</span>-axis and watch the slice of solution moving
forward in time.</p>
<p>There is also a view of <strong>moving frame</strong>. Following the
analogy of rails, then we ourselves are simply moving on the rails
together with the solution. As a result, we would not sense any shift in
the slice of solution, and rather would sense only the change in the
distribution of the solution. In the constant advection problem, the
shape remains the same, hence in the moving frame, we would sense
<em>no</em> change at all. Mathematically, the moving frame is
equivalent to have a change of variables and write the solution in terms
of <span class="math inline">\eta</span> and <span
class="math inline">t</span>.</p>
<p><mark>Heroku First-order PDE (2D) Case 1 Plots 1 and 2</mark></p>
<h2 data-number="3.2" id="finding-characteristics"><span
class="header-section-number">3.2</span> Finding characteristics</h2>
<p>The key takeaway from the previous section is, if we can find the
characteristics of a first-order PDE, then we probably can use the
characteristics to simplify and solve the IVP. Now the question becomes
how to find the characteristics. To do so we will leverage the concept
of total derivative from multi-variate calculus.</p>
<p>The total derivative of a multivariate function <span
class="math inline">u(x,t)</span> with respect to <span
class="math inline">t</span> is, <span id="eq:td"><span
class="math display">
{\color{red} \frac{\mathrm{d}u}{\mathrm{d}t}} = u_x {\color{blue}
\frac{\mathrm{d}x}{\mathrm{d}t}} + u_t
\qquad{(4)}</span></span> Now we rearrange the first-order PDE and
compare it side by side with Eq. 4, <span id="eq:pde"><span
class="math display">
{\color{red} S} = u_x {\color{blue} V} + u_t
\qquad{(5)}</span></span> Clearly, there is a striking similarity
between Eq. 4 and Eq. 5, highlighted by the color coding. Since the
total derivative formula Eq. 4 is valid for an arbitrary function, the
similarity indicates that our first-order PDE should be representing
some form of total derivative of <span class="math inline">u</span>
<em>as well</em>. In other words, it seems natural to set <span
id="eq:odes"><span class="math display">
\frac{\mathrm{d}u}{\mathrm{d}t} = S,\quad
\frac{\mathrm{d}x}{\mathrm{d}t}=V
\qquad{(6)}</span></span> If we solve the second ODE starting from a
point <span class="math inline">P</span> on the <span
class="math inline">x</span>-axis, e.g., <span
class="math inline">x=\eta</span>, <span class="math inline">t=0</span>,
then we would find <span class="math inline">x</span> as a function of
<span class="math inline">t</span> that passes through the point <span
class="math inline">(\eta,0)</span>. For example, in the constant
advection problem, and we can solve <span class="math display">
\frac{\mathrm{d}x}{\mathrm{d}t}=V,\quad x(t=0)=\eta
</span> to find <span class="math inline">x=Vt+\eta</span>, or <span
class="math inline">\eta=f(x,t)=x-Vt</span>. This is exactly what we
called as characteristics, and this line starts from the point <span
class="math inline">(\eta,0)</span> and runs forward in time.</p>
<p>Next, at point <span class="math inline">P</span>, we also know <span
class="math inline">u(\eta,0)=\phi(\eta)</span>, so we can supply the
first ODE in Eq. 6 with initial conditions <span
class="math inline">t=0</span>, <span
class="math inline">u=\phi(\eta)</span>. For example, in the constant
advection problem, we have <span class="math inline">S=0</span> and
<span class="math display">
\frac{\mathrm{d}u}{\mathrm{d}t}=0,\quad u(t=0)=\phi(\eta)
</span> Clearly the solution is <span
class="math inline">u=\text{const}=\phi(\eta)</span>, which is valid
along the characteristics.</p>
<p>Lastly, once we have found the characteristics equation <span
class="math inline">\eta=f(x,t)</span> and the solution <span
class="math inline">u</span> along the characteristics, we can combine
the solutions to find the solution to the first-order PDE. Again, for
the example of constant advection, we know <span
class="math inline">\eta=x-Vt</span> and <span
class="math inline">u=\phi(\eta)</span>, and thus the final solution is
<span class="math display">
u(x,t) = \phi(\eta) = \phi(x-Vt)
</span> just exactly as what we found earlier in Eq. 3.</p>
<h2 data-number="3.3" id="summary-of-method"><span
class="header-section-number">3.3</span> Summary of method</h2>
<p>The above discussion lays out the steps of the method of
characteristics for the IVP of a first-order PDE. In the following we
summarize the method as a <strong>trilogy</strong></p>
<ol type="1">
<li>Convert the problem into two IVPs of ODEs: <span
class="math display">
\begin{aligned}
\frac{\mathrm{d}x}{\mathrm{d}t}&amp;=V,\quad x(t=0)=\eta \\
\frac{\mathrm{d}u}{\mathrm{d}t}&amp;=S,\quad u(t=0)=\phi(\eta)
\end{aligned}
</span></li>
<li>Solve the two ODEs and obtain (1) <span class="math inline">x</span>
as a function of <span class="math inline">(t,\eta)</span> and (2) <span
class="math inline">u</span> as a function of <span
class="math inline">(t,\eta)</span>.</li>
<li>Rearrange <span class="math inline">x(t,\eta)</span> to obtain the
characteristics <span class="math inline">\eta=f(x,t)</span>; eliminate
<span class="math inline">\eta</span> in <span
class="math inline">u</span> and obtain the final solution <span
class="math inline">u(x,t)</span>.</li>
</ol>
<h1 data-number="4" id="examples"><span
class="header-section-number">4</span> Examples</h1>
<p>Here we provide a series of examples of increasing complexity, and
illustrate the typical behaviors of first-order PDEs. When not
explicitly specified, we continue to use the single wave equation, <span
class="math inline">\phi(x)=\exp(-(x-2)^2/2)</span>, as the initial
condition for the IVP.</p>
<h2 data-number="4.1" id="non-uniform-advection-homogeneous-case"><span
class="header-section-number">4.1</span> Non-uniform advection:
Homogeneous case</h2>
<p>We consider the following problem <span id="eq:eg1"><span
class="math display">
u_t+e^{-t}u_x = 0,\quad u(x,0) = \phi(x)
\qquad{(7)}</span></span></p>
<p>First, we identify that <span class="math inline">V=e^{-t}</span> and
<span class="math inline">S=0</span>, which gives us the ODEs <span
class="math display">
\begin{aligned}
\frac{\mathrm{d}x}{\mathrm{d}t}&amp;=V=e^{-t},\quad x(t=0)=\eta \\
\frac{\mathrm{d}u}{\mathrm{d}t}&amp;=S=0,\quad u(t=0)=\phi(\eta)
\end{aligned}
</span> Here <span class="math inline">\eta</span> means we are picking
an arbitrary point <span class="math inline">x=\eta</span> on the <span
class="math inline">x</span>-axis.</p>
<p>Next, we solve the first ODE for the characteristics. From the ODE we
find <span class="math inline">x = -e^{-t} + d_0</span> with
undetermined coefficient <span class="math inline">d_0</span>. From the
IC, <span class="math inline">\eta=-e^{-0}+d_0</span>, we find <span
class="math inline">d_0=\eta+1</span>, so the characteristics is <span
class="math display">
x = -e^{-t} + \eta + 1,\quad\text{or}\quad \eta = x + e^{-t} - 1
</span> Intuitively, thinking <span
class="math inline">\frac{\mathrm{d}x}{\mathrm{d}t}</span> as the speed
of advection, the ODE indicates that the speed decreases over time. We
can confirm the intuition by plotting the characteristics for several
values of <span class="math inline">\eta</span>. Indeed, initially the
characteristics move to the right but gradually come to a halt as time
increases.</p>
<p>Subsequently, we solve the second ODE that tells us the evolution of
<span class="math inline">u</span> along one characteristics. In this
example, the ODE is easy to solve, <span class="math inline">u</span>
stays constant all the time: <span class="math display">
u=\phi(\eta)
</span> Intuitively, since the source term is zero, nothing is added or
removed from <span class="math inline">u</span>, and hence <span
class="math inline">u</span> is not changing over time.</p>
<p>Lastly, we combine the ODE solutions to obtain the complete PDE
solution: <span class="math display">
u(x,t)=\phi(\eta)=\phi(x + e^{-t} - 1)
</span> Looking at the visualization, the characteristics are as if
rails and the initial condition moves exactly along the characteristics.
And again, imagine if we are in the moving frame of the characteristics,
i.e., moving at the given advection speed, then we would see <span
class="math inline">u</span> stays absolutely unchanged starting from
the initial condition.</p>
<p><mark>Heroku First-order PDE (2D) Case 2</mark></p>
<h2 data-number="4.2"
id="non-uniform-advection-non-homogeneous-case"><span
class="header-section-number">4.2</span> Non-uniform advection:
Non-homogeneous case</h2>
<p>Next, we modify the problem a little bit <span id="eq:eg2"><span
class="math display">
u_t+e^{-t}u_x = -u^2,\quad u(x,0) = \phi(x)
\qquad{(8)}</span></span></p>
<p>First, we identify that <span class="math inline">V=e^{-t}</span> and
<span class="math inline">S=-u^2</span>, which gives us the ODEs <span
class="math display">
\begin{aligned}
\frac{\mathrm{d}x}{\mathrm{d}t}&amp;=V=e^{-t},\quad x(t=0)=\eta \\
\frac{\mathrm{d}u}{\mathrm{d}t}&amp;=S=-u^2,\quad u(t=0)=\phi(\eta)
\end{aligned}
</span></p>
<p>Next, the first ODE is the same as the previous example, and the
characteristics has been found to be <span class="math display">
\eta = x + e^{-t} - 1
</span></p>
<p>Subsequently, we solve the second ODE, that is more complex than the
previous example. From the ODE, <span class="math display">
\begin{aligned}
\frac{\mathrm{d}u}{-u^2} &amp;= \mathrm{d}t \\
\frac{1}{u} &amp;= t + d_0 \\
u &amp;= \frac{1}{t+d_0}
\end{aligned}
</span> From the IC, <span class="math display">
u(t=0) = \phi(\eta) = \frac{1}{0+d_0}\quad\Rightarrow\quad
d_0=\frac{1}{\phi(\eta)}
</span> so the final ODE solution is <span class="math display">
u = \frac{1}{t+d_0} = \frac{1}{t+1/\phi(\eta)} =
\frac{\phi(\eta)}{t\phi(\eta)+1}
</span></p>
<p>Lastly, we combine the ODE solutions to obtain the complete PDE
solution: <span class="math display">
u(x,t)=\frac{\phi(x + e^{-t} - 1)}{t\phi(x + e^{-t} - 1)+1}
</span> Looking at the visualization, the characteristics are still
functioning as if guidelines and the initial condition moves exactly
along the characteristics. But the difference is that <span
class="math inline">u</span> itself is changing as it moves along the
characteristics. If we look at the moving frame, while <span
class="math inline">u</span> is not shifting to right or left as usual,
its amplitude decreases as time increases.</p>
<p><mark>Heroku First-order PDE (2D) Case 3</mark></p>
<p>We can also compare side by side the solutions of the homogeneous and
non-homogeneous cases in 3D surface plots. The two plots show the same
curved distortion to the positive <span
class="math inline">x</span>-direction as time increases, which is due
to the identical set of characteristics. The difference is that, the
amplitude of solution in homogeneous case remains constant over time,
while the amplitude in the other case gradually decays; the difference
is attributed to the extra source term in the latter case.</p>
<blockquote>
<p>Exercise: What if the source term is <span
class="math inline">u^2</span>? First think intuitively, and then verify
your intuition.</p>
</blockquote>
<p><mark>Heroku First-order PDE (3D) Cases 2 and 3, side by
side</mark></p>
<h2 data-number="4.3" id="nonlinear-advection"><span
class="header-section-number">4.3</span> Nonlinear advection</h2>
<p>Lastly, we touch upon a more complex problem, <span id="eq:eg3"><span
class="math display">
u_t+uu_x = 0,\quad u(x,0) = \phi(x) = 1-x^2
\qquad{(9)}</span></span> You might recognize this equation from the
motivating example of traffic flow.</p>
<p>We again start with identifying the ODEs <span class="math display">
\begin{aligned}
\frac{\mathrm{d}x}{\mathrm{d}t}&amp;=u,\quad x(t=0)=\eta \\
\frac{\mathrm{d}u}{\mathrm{d}t}&amp;=0,\quad u(t=0)=1-\eta^2
\end{aligned}
</span> Note that now the ODE for characteristics basically says that
the advection speed is larger when <span class="math inline">u</span> is
larger, and the speed may become negative if <span
class="math inline">u</span> is negative; the ODE now involves the
unknown function <span class="math inline">u</span> and cannot be solved
directly.</p>
<p>Instead, we attempt to first solve the ODE for <span
class="math inline">u</span>, which, luckily, is rather simple: <span
class="math display">
u=\text{const}=1-\eta^2
</span> Subsequently, returning to the first ODE, which now becomes,
<span class="math display">
\frac{\mathrm{d}x}{\mathrm{d}t}=u=1-\eta^2,\quad x(t=0)=\eta
</span> and we have <span class="math inline">x=(1-\eta^2)t +
d_0</span>. Using the IC, <span
class="math inline">\eta=(1-\eta^2)\times 0 + d_0</span>, we get <span
class="math inline">d_0=\eta</span>, so the characteristics equation is
<span class="math display">
x=(1-\eta^2)t + \eta
</span> The first complication we see here is that <span
class="math inline">\eta</span> is an implicit function of <span
class="math inline">(x,t)</span>. But still, we could find an explicit
expression of <span class="math inline">\eta</span> by solving a
quadratic equation, and find <span class="math display">
\eta = \frac{1-\sqrt{1+4t^2-4xt}}{2t}
</span></p>
<blockquote>
<p>Exercise: A quadratic equation always has two roots. Think about why
we throw away one of the roots here.</p>
<p>Hint: Look at <span class="math inline">t=0</span>.</p>
</blockquote>
<p>Lastly, we can combine the two ODE solutions to find the PDE
solution, <span id="eq:eg3s"><span class="math display">
u(x,t) = 1-\eta^2 = \frac{-1+2tx+\sqrt{1+4t^2-4xt}}{2t^2}
\qquad{(10)}</span></span> The solution looks relatively more complex
than previous ones. The visualization shows the second complication. It
is clear that this time the characteristics are no longer parallel to
each other. In some regions, the lines move away from each other, while
in some other regions the lines move closer. This non-uniformity is due
to the dependency of advection speed on the solution <span
class="math inline">u</span> itself. As a result, while <span
class="math inline">u</span> would still move along the characteristics,
the distribution would be distorted by the characteristics.</p>
<p><mark>Heroku First-order PDE, a taste of shocks (2D)</mark></p>
<blockquote>
<p>Problem solved? Is Eq. 10 as “harmless” as it looks? For example, is
the solution defined when <span class="math inline">t=1/2</span> and
<span class="math inline">x&gt;1</span>?</p>
<p>This is where we see a “shock” in the solution. We will discuss more
in the advanced topics.</p>
</blockquote>
<h1 data-number="5" id="advanced-topics"><span
class="header-section-number">5</span> Advanced Topics</h1>
<p><mark><em>These will not be covered in class, and the full text will
be developed in the final version of book.</em></mark></p>
<h2 data-number="5.1" id="more-general-case"><span
class="header-section-number">5.1</span> More general case</h2>
<p><mark><em>We give a more general treatment of the PDE.</em></mark>
<span class="math display">
\begin{aligned}
\text{PDE:} &amp;\quad a(u,x,t)u_t+b(u,x,t)u_x = c(u,x,t) \\
\text{IC:} &amp;\quad u(\xi) = u_0(\xi)\text{ on }x=x_0(\xi),\
y=y_0(\xi)
\end{aligned}
</span></p>
<h2 data-number="5.2" id="existence-of-solution"><span
class="header-section-number">5.2</span> Existence of solution</h2>
<p><mark><em>For mathematical rigor, we discuss when the solution
exists.</em></mark></p>
<h2 data-number="5.3" id="when-things-break-down"><span
class="header-section-number">5.3</span> When things break down</h2>
<p><mark>Now we formally formulate the problems of shocks and expansion
waves, and discuss how to tackle these cases.</mark></p>
</body>
</html>
